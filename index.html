<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Products Pagination</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      #products div {
        margin-bottom: 8px;
      }
      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <h1>Product List</h1>
    <div id="products">Loading...</div>

    <select id="categoryFilter">
      <option value="">All Categories</option>
      <option value="category 3">Category 3</option>
      <option value="category 5">Category 5</option>
      <option value="category 6">Category 6</option>
      <!-- Add other categories if needed -->
    </select>

    <select id="materialFilter">
      <option value="">All Materials</option>
      <option value="materials 2">Materials 2</option>
      <option value="materials 3">Materials 3</option>
      <option value="materials 5">Materials 5</option>
      <!-- Add other materials if needed -->
    </select>

    <div id="products">Loading...</div>

    <button id="prevBtn">Previous</button>
    <span id="pageInfo"></span>
    <button id="nextBtn">Next</button>

    <script>
      let currentPage = 1;
      const limit = 5;
      let totalPages = 1;
      let currentCategory = "";
      let currentMaterial = "";

      async function fetchPage(page) {
        const categoryParam = currentCategory
          ? `&category=${encodeURIComponent(currentCategory)}`
          : "";
        const materialParam = currentMaterial
          ? `&materials=${encodeURIComponent(currentMaterial)}`
          : "";
        const url = `http://localhost:3000/admin/products?page=${page}&limit=${limit}${categoryParam}${materialParam}`;

        const res = await fetch(url);
        const data = await res.json();

        totalPages = data.totalPages || 1;
        currentPage = data.page;

        const productsDiv = document.getElementById("products");
        if (data.items.length === 0) {
          productsDiv.innerHTML = "<p>No products found.</p>";
        } else {
          productsDiv.innerHTML = data.items
            .map((item) => `<div>${item.name || "Unnamed Product"}</div>`)
            .join("");
        }

        document.getElementById(
          "pageInfo"
        ).innerText = `Page ${currentPage} of ${totalPages}`;
        document.getElementById("prevBtn").disabled = currentPage <= 1;
        document.getElementById("nextBtn").disabled = currentPage >= totalPages;
      }

      document.getElementById("categoryFilter").onchange = (e) => {
        currentCategory = e.target.value;
        currentPage = 1;
        fetchPage(currentPage);
      };

      document.getElementById("materialFilter").onchange = (e) => {
        currentMaterial = e.target.value;
        currentPage = 1;
        fetchPage(currentPage);
      };

      document.getElementById("prevBtn").onclick = () => {
        if (currentPage > 1) fetchPage(currentPage - 1);
      };

      document.getElementById("nextBtn").onclick = () => {
        if (currentPage < totalPages) fetchPage(currentPage + 1);
      };

      fetchPage(currentPage);
    </script>
  </body>
</html>
